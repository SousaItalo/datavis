<html>
	<head>
		<meta charset="utf-8">
    	<title>movies_d3_dc</title>
    	<link rel="stylesheet" href="css/dc.css">
    	<link rel="stylesheet" href="css/styles.css">
    	<script src="js/crossfilter.js" charset="utf-8"></script>
    	<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    	<script src="js/dc.js" charset="utf-8"></script>
	</head>
	<body>
		<h1>Bilheterias por Ano</h1>
		<div id="bilheteria"></div>
		<script>
			var chart1 = dc.barChart("#bilheteria");
			
			d3.json("movies.json", function(error, data){
				
				//formatando dados
				data.forEach(function(d){
					d.Year = +d.Year;
					d.Worldwide_Gross_M = +d.Worldwide_Gross_M;
				});
				
				//criando crossfilter
				var movies = crossfilter(data);
				//criando dimens√£o de anos
				var dateDim = movies.dimension(function(d){
					return d.Year;
					console.log(d.Year);
				});
				
				var worldWideByGroup = dateDim.group().reduceSum(function(d){
					return d.Worldwide_Gross_M;
				});
				
				chart1.width(800)
					.height(400)
					.x(d3.scale.linear().domain([dateDim.bottom(1)[0].Year - 0.5, dateDim.top(1)[0].Year + 0.5]))
					.brushOn(false)
					.dimension(dateDim)
					.group(worldWideByGroup)
					.xAxis().tickFormat(d3.format("d"));
    			
    			dc.renderAll();
			});
		</script>
	</body>
</html>
